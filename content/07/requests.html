
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HTTP Requests &#8212; Data Science in Practice</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Parsing HTML" href="html.html" />
    <link rel="prev" title="Using Existing Data" href="existing-data.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/toolbox.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Data Science in Practice</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction.html">
   Data Science in Practice
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Section 1: Understanding Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01/introduction.html">
   1. Introduction to Data Science
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/what-is-data-science.html">
     1.1. What is Data Science?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/scientific-method.html">
     1.2. The Scientific Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/data-science-example.html">
     1.3. A Data Science Example
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02/introduction.html">
   2. Tabular Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/tabular-data.html">
     2.1. Introduction to Tabular Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/methods.html">
     2.2. DataFrame Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/data-types.html">
     2.3. Data Types and Performance
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03/introduction.html">
   3. Querying and Describing Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/selecting-data.html">
     3.1. Selecting Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/kinds-of-data.html">
     3.2. Kinds of Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/categorical-distributions.html">
     3.3. Categorical Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/quantitative-distributions.html">
     3.4. Quantitative Distributions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../04/introduction.html">
   4. Understanding Assumptions and Data Cleaning
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/modifying-dataframes.html">
     4.1. Modifying DataFrames
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/cleaning.html">
     4.2. Cleaning Messy Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/eda.html">
     4.3. Exploratory Data Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/asking-questions.html">
     4.4. Hypothesis Testing
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../05/introduction.html">
   5. Aggregation and Extension of Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/grouping.html">
     5.1. Data Granularity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/understanding-aggregations.html">
     5.2. Understanding Aggregations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/appending-data.html">
     5.3. Combining Data (Observations)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/joining-data.html">
     5.4. Combining Data (Attributes)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/permutation-tests.html">
     5.5. Permutation Tests
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/eda-2.html">
     5.6. Exploratory Data Analysis II
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../06/introduction.html">
   6. Missing Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/defining-missing.html">
     6.1. Definitions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/identifying-missing.html">
     6.2. Identifying Missing Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/handling-missing-data.html">
     6.3. Handling Missing Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/single-valued-imputation.html">
     6.4. Single-Valued Imputation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/probabilistic-imputation.html">
     6.5. Probabilistic Imputation
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Section 2: Collecting Data
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="introduction.html">
   7. Data Collection
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="existing-data.html">
     7.1. Using Existing Data
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     7.2. HTTP Requests
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="html.html">
     7.3. Parsing HTML
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../08/introduction.html">
   8. Information Extaction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../08/patterns.html">
     8.1. Text Processing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08/nlp.html">
     8.2. Natural Language Processing
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../09/introduction.html">
   9. Introduction to Features
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../09/features.html">
     9.1. Feature Engineering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09/data-pipelines.html">
     9.2. Data Pipelines
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Section 3: Modeling With Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../10/introduction.html">
   10. Modeling Basics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../10/intro-modeling.html">
     10.1. Introduction to Statistical Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../10/model-building.html">
     10.2. Building Modeling Pipelines
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../11/introduction.html">
   11. Bias and Variance
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../11/fitting-inference.html">
     11.1. Model Quality (Inference)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11/fitting-prediction.html">
     11.2. Model Quality (Prediction)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11/cross-validation.html">
     11.3. Cross Validation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11/parameter-search.html">
     11.4. Parameter Search
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../12/introduction.html">
   12. Evaluating Models; Fairness
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../12/eval.html">
     12.1. Evaluation metrics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12/parity.html">
     12.2. Parity Measures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12/fairness.html">
     12.3. Fairness in Machine Learning
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/content/07/requests.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/dsc-courses/ds-in-practice/master?urlpath=tree/book/content/07/requests.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-anatomy-of-http">
   The anatomy of HTTP
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     HTTP Requests
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#http-responses">
     HTTP Responses
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#python-s-requests-library">
   Python’s
   <code class="docutils literal notranslate">
    <span class="pre">
     requests
    </span>
   </code>
   library
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#responsible-use-of-http-requests">
   Responsible use of HTTP requests
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#designing-requests-code">
     Designing
     <code class="docutils literal notranslate">
      <span class="pre">
       requests
      </span>
     </code>
     code
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-apis">
   Data APIs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scraping-basics">
   Scraping Basics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#designing-scraping-code">
     Designing scraping code
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>HTTP Requests</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-anatomy-of-http">
   The anatomy of HTTP
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     HTTP Requests
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#http-responses">
     HTTP Responses
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#python-s-requests-library">
   Python’s
   <code class="docutils literal notranslate">
    <span class="pre">
     requests
    </span>
   </code>
   library
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#responsible-use-of-http-requests">
   Responsible use of HTTP requests
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#designing-requests-code">
     Designing
     <code class="docutils literal notranslate">
      <span class="pre">
       requests
      </span>
     </code>
     code
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-apis">
   Data APIs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scraping-basics">
   Scraping Basics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#designing-scraping-code">
     Designing scraping code
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="http-requests">
<h1>HTTP Requests<a class="headerlink" href="#http-requests" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p>Data over the Internet are transmitted via <em>HTTP requests</em>. For example, a user browsing on a computer might want to watch a streaming video. By clicking on the link for the video, she makes a <em>request</em> for the video content. The request is sent via HTTP to a server (or computer) containing the video, which then <em>responds</em> with requested video.</p>
<p>HTTP requests follow a request-response protocol: a client (i.e. user) makes a request and waits for a response from the server.</p>
<img src="imgs/req-resp.png">
<p>Most communication between computers use this protocol. This includes:</p>
<ul class="simple">
<li><p>Requesting the content of a webpage.</p></li>
<li><p>Requesting access to a secured user account.</p></li>
<li><p>One server requiring information from another (on an internal network).</p></li>
</ul>
<p>A Data Scientist might explicitly leverage HTTP requests when:</p>
<ul class="simple">
<li><p>Requesting updated data from an API (application programming interface).</p></li>
<li><p>Scraping data from a set of webpages.</p></li>
<li><p>Making the results of a prediction algorithm available to the public.</p></li>
</ul>
<div class="section" id="the-anatomy-of-http">
<h2>The anatomy of HTTP<a class="headerlink" href="#the-anatomy-of-http" title="Permalink to this headline">¶</a></h2>
<p>The <em>hypertext transfer protocol</em> (HTTP) follows the ‘request-response’ message exchange pattern between clients and servers.</p>
<ul class="simple">
<li><p>The server is discoverable and always available.</p></li>
<li><p>The client initiates a request to a server, then waits for a response.</p></li>
</ul>
<p>In order to communicate, the client and server must speak a common language.</p>
<div class="section" id="id1">
<h3>HTTP Requests<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>The anatomy of an HTTP request consists of:</p>
<ul class="simple">
<li><p>The <em>request line</em>, consisting of a <em>method</em>, <em>resource</em>, and <em>protocol version</em>.</p></li>
<li><p>The request <em>headers</em>, that provides other information about the request, including context about who is making the request.</p></li>
<li><p>The request <em>body</em>, that provides any additional information needed to make the request (e.g. a user-name and password).</p></li>
</ul>
<p><strong>Example:</strong> The HTTP-request below makes a request from <a class="reference external" href="http://www.catphotos.net">www.catphotos.net</a> to render a photo of a cat in the browser:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GET</span> <span class="o">/</span><span class="n">photos</span><span class="o">/</span><span class="n">cat</span><span class="o">.</span><span class="n">png</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="n">Host</span><span class="p">:</span> <span class="n">www</span><span class="o">.</span><span class="n">catphotos</span><span class="o">.</span><span class="n">net</span>
<span class="n">User</span><span class="o">-</span><span class="n">agent</span><span class="p">:</span> <span class="n">Mozilla</span><span class="o">/</span><span class="mf">4.0</span>
<span class="n">Connection</span><span class="p">:</span> <span class="n">close</span>
<span class="n">Accept</span><span class="o">-</span><span class="n">language</span><span class="p">:</span> <span class="n">en</span>

<span class="n">data</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The <em>method</em> is <code class="docutils literal notranslate"><span class="pre">GET</span></code></p></li>
<li><p>The resource being requested is <code class="docutils literal notranslate"><span class="pre">/photos/cat.png</span></code>. This is also known as the request target.</p></li>
<li><p>The headers contain:</p>
<ul>
<li><p>The host server where the resource lives.</p></li>
<li><p>The user-agent, which contains information on the browser in which the content will be displayed.</p></li>
<li><p>Whether the connection should be kept open, or closed, after the response is sent.</p></li>
<li><p>The preferred language of the client.</p></li>
</ul>
</li>
<li><p>The body in the request may contain other data.</p></li>
</ul>
<p>The method of an HTTP request lets the server know what is being requested of it. The most common requests are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GET</span></code> requests data from a server (e.g. a webpage, a dataset).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HEAD</span></code> is identical to <code class="docutils literal notranslate"><span class="pre">GET</span></code>, without returning a response body. This method allows a client to ‘preview’ a response.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">POST</span></code> sends data to a server (e.g. authentication, a file upload).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DELETE</span></code> deletes the specified resource on the server.</p></li>
</ul>
<p>This course will primarily request data using <code class="docutils literal notranslate"><span class="pre">GET</span></code>.</p>
</div>
<div class="section" id="http-responses">
<h3>HTTP Responses<a class="headerlink" href="#http-responses" title="Permalink to this headline">¶</a></h3>
<p>The anatomy of an HTTP response consists of:</p>
<ul class="simple">
<li><p>The <em>status line</em>, consisting of the <em>protocol version</em>, <em>status code</em>, and <em>status phrase</em>.</p></li>
<li><p>The <em>response headers</em>, that provide other information about the response, including information about the server that made the response, when the request was received, when the response was sent, etc.</p></li>
<li><p>The response <em>body</em> that includes the requested data.</p></li>
</ul>
<p><strong>Example:</strong> The HTTP response below corresponds to the request from a client to the server at <a class="reference external" href="http://www.catphotos.net">www.catphotos.net</a> to render a photo of a cat in the browser:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">200</span> <span class="n">OK</span>
<span class="n">Connection</span> <span class="n">close</span>
<span class="n">Date</span><span class="p">:</span> <span class="n">Thu</span><span class="p">,</span> <span class="mi">06</span> <span class="n">Aug</span> <span class="mi">2006</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">15</span> <span class="n">GMT</span>
<span class="n">Server</span><span class="p">:</span> <span class="n">Apache</span><span class="o">/</span><span class="mf">1.3.0</span> <span class="p">(</span><span class="n">Unix</span><span class="p">)</span>
<span class="n">Last</span><span class="o">-</span><span class="n">Modified</span><span class="p">:</span> <span class="n">Mon</span><span class="p">,</span> <span class="mi">22</span> <span class="n">Jun</span> <span class="mi">2006</span> <span class="o">...</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Length</span><span class="p">:</span> <span class="mi">682105</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">image</span><span class="o">/</span><span class="n">png</span>

<span class="n">iVBORw0KGgoAAAANSUhEUgAAANwAAA</span> <span class="o">...</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The <em>status</em> is <code class="docutils literal notranslate"><span class="pre">200</span></code>, meaning the request was successful.</p></li>
<li><p>The <em>status phrase</em> of a successful request is <code class="docutils literal notranslate"><span class="pre">OK</span></code>.</p></li>
<li><p>The <em>body</em> contains the data representing the image of the cat (encoded in base64, as text).</p></li>
</ul>
<p>The status code allows the client to classify and assess the success of a response, clarifying what may have gone wrong when the response was unexpected. Status codes fall into the following categories, with a few examples of each:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="n">xx</span><span class="p">:</span> <span class="n">Informational</span><span class="o">.</span> <span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="mi">100</span> <span class="n">Continue</span><span class="p">)</span>
<span class="mi">2</span><span class="n">xx</span><span class="p">:</span> <span class="n">Success</span><span class="o">.</span> <span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="mi">200</span> <span class="n">Success</span><span class="p">)</span>
<span class="mi">3</span><span class="n">xx</span><span class="p">:</span> <span class="n">Redirection</span><span class="o">.</span>
<span class="mi">4</span><span class="n">xx</span><span class="p">:</span> <span class="n">Client</span> <span class="n">Error</span><span class="o">.</span> <span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="mi">401</span> <span class="n">Bad</span> <span class="n">Request</span><span class="p">;</span> <span class="mi">403</span> <span class="n">Forbidden</span><span class="p">)</span>
<span class="mi">5</span><span class="n">xx</span><span class="p">:</span> <span class="n">Server</span> <span class="n">Error</span><span class="o">.</span> <span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="mi">500</span> <span class="n">Internal</span> <span class="n">Server</span> <span class="n">Error</span><span class="p">;</span> <span class="mi">509</span> <span class="n">Bandwidth</span> <span class="n">Limit</span> <span class="n">Exceeded</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="python-s-requests-library">
<h2>Python’s <code class="docutils literal notranslate"><span class="pre">requests</span></code> library<a class="headerlink" href="#python-s-requests-library" title="Permalink to this headline">¶</a></h2>
<p>Python’s <code class="docutils literal notranslate"><span class="pre">requests</span></code> library provides easy-to-use methods for making HTTP requests. The function <code class="docutils literal notranslate"><span class="pre">requests.get(url)</span></code> sends an HTTP request to a target <code class="docutils literal notranslate"><span class="pre">url</span></code>, returning an HTTP response:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://ucsd.edu&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The parts of the response are available as attributes of the response object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># status (codes)</span>
<span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">reason</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(200, &#39;OK&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Response Headers</span>
<span class="n">resp</span><span class="o">.</span><span class="n">headers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Date&#39;: &#39;Sun, 27 Oct 2019 06:04:49 GMT&#39;, &#39;Server&#39;: &#39;Apache/2&#39;, &#39;Last-Modified&#39;: &#39;Fri, 25 Oct 2019 22:00:02 GMT&#39;, &#39;ETag&#39;: &#39;&quot;8dc17-595c345935c80&quot;&#39;, &#39;Accept-Ranges&#39;: &#39;bytes&#39;, &#39;Keep-Alive&#39;: &#39;timeout=15, max=100&#39;, &#39;Connection&#39;: &#39;Keep-Alive&#39;, &#39;Content-Type&#39;: &#39;text/html; charset=UTF-8&#39;, &#39;Transfer-Encoding&#39;: &#39;chunked&#39;, &#39;Content-Encoding&#39;: &#39;gzip&#39;, &#39;Vary&#39;: &#39;Accept-encoding&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Body (text of the webpage)</span>
<span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;&lt;!DOCTYPE html&gt;\n&lt;html lang=&quot;en&quot;&gt;\n  &lt;head&gt;\n  \n  \n\n &#39;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="responsible-use-of-http-requests">
<h2>Responsible use of HTTP requests<a class="headerlink" href="#responsible-use-of-http-requests" title="Permalink to this headline">¶</a></h2>
<p>Data collection tasks often involve sending HTTP requests <em>in bulk</em>. When sending a high volume of requests, one should always be careful with how the request logic is designed. Every request sent occupies the resources of the target server, <em>costing the owners of the server money</em> or even <em>bringing the website offline</em>. This observation mandates responsible use of HTTP requests, over both ethical and legal concerns.</p>
<p><strong>Example:</strong> A <a class="reference external" href="http://www.storybench.org/to-scrape-or-not-to-scrape-the-technical-and-ethical-challenges-of-collecting-data-off-the-web/">journalist</a>, frustrated with a prison’s failure to respond to a request for information, decided to take matters into their own hand by using HTTP requests to scape information straight from the prison’s website. The requests were so numerous, the prison website shut down. During this time, the family members were unable to contact their loved ones in prison.</p>
<p>Guidelines for responsibly communicating via HTTP requests are:</p>
<ul class="simple">
<li><p>Be transparent about what is making the requests (e.g. by changing the headers).</p></li>
<li><p>Check the website or API for what is allowed (e.g. check <code class="docutils literal notranslate"><span class="pre">robots.txt</span></code> and terms of service).</p></li>
<li><p>Make requests as slowly as possible, avoiding repetitive request patterns.</p></li>
</ul>
<p>Excessive use of HTTP requests may cause a server to block the client’s IP Address, adversely affecting not only the irresponsible user, but those around them as well. Additionally, irresponsible use of rapid requests may cause the server to shut down (negatively affecting others) and bring about legal action.</p>
<div class="section" id="designing-requests-code">
<h3>Designing <code class="docutils literal notranslate"><span class="pre">requests</span></code> code<a class="headerlink" href="#designing-requests-code" title="Permalink to this headline">¶</a></h3>
<p>Well designed code making HTTP requests will:</p>
<ul class="simple">
<li><p>Responsibly limit request volume and velocity,</p></li>
<li><p>Be fault tolerant to failed requests,</p></li>
<li><p>Should ideally be <em>idempotent</em> (a successful request, made a second time, has no result).</p></li>
</ul>
<p>To limit the volume of requests, avoid unnecessary calls to a target url. For example, when developing code to process the response data, request the data <em>once</em>, save it, and develop on the cached data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resp</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span>
<span class="c1"># develop `process` after saving body</span>
<span class="n">process</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>When making many requests in succession, not every one is successful. For example, a request may fail because the target resource doesn’t exist, or a website is limiting the rate at which the requests may be made. To handle unsuccessful requests, use:</p>
<ul class="simple">
<li><p>response status codes to implement a ‘try-retry’ structure,</p></li>
<li><p>maintain a list of failed and successful client requests,</p></li>
<li><p>‘back-off’ the velocity of requests when the server limits the request rates.</p></li>
</ul>
<p>For example, making an HTTP request that retries upon failure (with so called “exponential back-off”) is given in the function below. Such a function is useful when a target url attempts to limit the rate of requests from a client:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">request_with_retries</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">max_retry</span><span class="p">,</span> <span class="n">retry</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;returns a http reponse to the request to target url. If &#39;&#39;&#39;</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">resp</span>
    <span class="k">elif</span> <span class="n">retry</span> <span class="o">&lt;</span> <span class="n">max_retry</span><span class="p">:</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">retry</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">request_with_retries</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">max_retry</span><span class="p">,</span> <span class="n">retry</span><span class="o">=</span><span class="p">(</span><span class="n">retry</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">resp</span>
</pre></div>
</div>
</div>
</div>
<p>Maintaining a simple log of successful and failed requests is useful to maintain a ledger of the current state of data collection:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">request_with_logging</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">F</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;returns the request and updated lists of</span>
<span class="sd">    successful (S) and failed (F) target urls.</span>
<span class="sd">    It returns None if the request has already </span>
<span class="sd">    been succesfully made.&#39;&#39;&#39;</span>
    
    <span class="k">if</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">S</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">F</span>
    
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">resp</span><span class="p">,</span> <span class="n">S</span> <span class="o">+</span> <span class="p">[</span><span class="n">url</span><span class="p">],</span> <span class="n">F</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">resp</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">F</span> <span class="o">+</span> <span class="p">[</span><span class="n">url</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="data-apis">
<h2>Data APIs<a class="headerlink" href="#data-apis" title="Permalink to this headline">¶</a></h2>
<p>Websites sometimes make data available especially for programmatic consumption through a <em>data API</em>, or application programming interface. Requesting data through a public API is the best way to collect data:</p>
<ul class="simple">
<li><p>APIs are designed for programmatic consumption, giving implicit permission to access data.</p></li>
<li><p>The intentional design of APIs come with preferred best-practices for the given owner (permissions, rate-of-request).</p></li>
<li><p>APIs are typically orgranized, documented, and kept up-to-date.</p></li>
</ul>
<p>A common type of API is a REST API, which returns Javascript Object Notation (JSON).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://www.getmydata.com/v1/articles&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;articleId&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;article name 1&#39;</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;...&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;articleId&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;article name 2&#39;</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;...&#39;</span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><em>Remarks:</em></p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">v1</span></code> in the target url describes the version of the API-endpoint (for reference in documentation).</p></li>
<li><p>The output JSON is parsed as a list of python dictionaries.</p></li>
</ul>
<p>One can also include complex queries in the data by including additional data into the target url; this process is called ‘url encoding’. For example, one might request only science articles from 2015 by using the request:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://www.getmydata.com/v1/articles?date=2015&amp;genre=science&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</pre></div>
</div>
</div>
</div>
<p>The query fields are usually found in the API documentation, corresponding to version <code class="docutils literal notranslate"><span class="pre">v1</span></code>.</p>
</div>
<div class="section" id="scraping-basics">
<h2>Scraping Basics<a class="headerlink" href="#scraping-basics" title="Permalink to this headline">¶</a></h2>
<p>Screen scraping refers to programmatically browsing the web, downloading and parsing the source HTML of each webpage. Screen scraping is a useful data collection technique, as it’s possible whenever a page is visible to the public eye. However, it should be considered as a last resort for a number of reasons:</p>
<ul class="simple">
<li><p>Data derived from raw HTML and javascript are difficult to parse and clean.</p></li>
<li><p>The source of webpages changes often, making scraping code hard to maintain.</p></li>
<li><p>Scraping costs webpage owners money.</p></li>
</ul>
<p>There are good reasons for scraping as well:</p>
<ul class="simple">
<li><p>Not all scraping is unethical; sometimes it brings value to the webpage owner.</p></li>
<li><p>Search engines scrape webpages to index them and make them searchable.</p></li>
<li><p>Making an API takes work and the site owner has no qualms with moderate amount of data collection.</p></li>
</ul>
<p>Best practices for scraping include keeping the rate of requests slow, respecting the policy laid out in the <code class="docutils literal notranslate"><span class="pre">robots.txt</span></code> file, and following the website’s terms of service.</p>
<div class="section" id="designing-scraping-code">
<h3>Designing scraping code<a class="headerlink" href="#designing-scraping-code" title="Permalink to this headline">¶</a></h3>
<p>Collecting data from websites through scraping usually involves requesting and parsing HTML from many different websites. Such code should be separated into functionally different pieces. For example, the pieces of scraping code may break up into the following pieces:</p>
<ul class="simple">
<li><p>Managing all urls requested,</p></li>
<li><p>Executing the request-response protocol,</p></li>
<li><p>Parsing the HTML to extract need data from the source.</p></li>
</ul>
<p>In particular the HTML extraction should be developed on data that is only requested <em>once</em>. Don’t make unneeded requests before data is even being collected!</p>
<p><strong>Example:</strong> The simple scraper below makes simple attempts to implement responsible scraping concepts:</p>
<ul class="simple">
<li><p>Logging to keep track of urls that have been successfully or unsuccessfully requested,</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">parse_html</span></code> function that processes a successful http-response.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SimpleScraper</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">failure</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="k">def</span> <span class="nf">make_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">url</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">resp</span> <span class="o">=</span> <span class="n">request_with_retries</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">resp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">failure</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">resp</span>
        
    <span class="k">def</span> <span class="nf">parse_html</span><span class="p">(</span><span class="n">resp</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">resp</span> <span class="ow">and</span> <span class="n">resp</span><span class="o">.</span><span class="n">ok</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        
        <span class="n">parsed</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># code for parsing HTML</span>
        <span class="k">return</span> <span class="n">parsed</span>
    
    <span class="k">def</span> <span class="nf">scrape</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_request</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="n">parsed</span> <span class="o">=</span> <span class="n">parse_html</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">parsed</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/07"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="existing-data.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Using Existing Data</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="html.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Parsing HTML</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Aaron Fraenkel<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>