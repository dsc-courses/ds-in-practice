
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Understanding Aggregations &#8212; Data Science in Practice</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Combining Data: Observations" href="appending-data.html" />
    <link rel="prev" title="Data Granularity:" href="grouping.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/toolbox.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Data Science in Practice</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction.html">
   Data Science in Practice
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Section 1: Understanding Data
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01/introduction.html">
   1. Introduction to Data Science
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/what-is-data-science.html">
     1.1. What is Data Science?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/scientific-method.html">
     1.2. The Scientific Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/data-science-example.html">
     1.3. A Data Science Example
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02/introduction.html">
   2. Tabular Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/tabular-data.html">
     2.1. Introduction to Tabular Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/methods.html">
     2.2. DataFrame Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/data-types.html">
     2.3. Data Types and Performance
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03/introduction.html">
   3. Querying and Describing Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/selecting-data.html">
     3.1. Selecting Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/kinds-of-data.html">
     3.2. Kinds of Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/categorical-distributions.html">
     3.3. Categorical Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/quantitative-distributions.html">
     3.4. Quantitative Distributions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../04/introduction.html">
   4. Understanding Assumptions and Data Cleaning
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/modifying-dataframes.html">
     4.1. Modifying DataFrames
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/cleaning.html">
     4.2. Cleaning Messy Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/eda.html">
     4.3. Exploratory Data Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/asking-questions.html">
     4.4. Hypothesis Testing
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="introduction.html">
   5. Aggregation and Extension of Data
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="grouping.html">
     5.1. Data Granularity
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     5.2. Understanding Aggregations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="appending-data.html">
     5.3. Combining Data (Observations)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="joining-data.html">
     5.4. Combining Data (Attributes)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="permutation-tests.html">
     5.5. Permutation Tests
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eda-2.html">
     5.6. Exploratory Data Analysis II
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../06/introduction.html">
   6. Missing Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/defining-missing.html">
     6.1. Definitions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/identifying-missing.html">
     6.2. Identifying Missing Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/handling-missing-data.html">
     6.3. Handling Missing Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/single-valued-imputation.html">
     6.4. Single-Valued Imputation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/probabilistic-imputation.html">
     6.5. Probabilistic Imputation
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Section 2: Collecting Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../07/introduction.html">
   7. Data Collection
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../07/existing-data.html">
     7.1. Using Existing Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07/requests.html">
     7.2. HTTP Requests
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07/html.html">
     7.3. Parsing HTML
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../08/introduction.html">
   8. Information Extaction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../08/patterns.html">
     8.1. Text Processing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../08/nlp.html">
     8.2. Natural Language Processing
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../09/introduction.html">
   9. Introduction to Features
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../09/features.html">
     9.1. Feature Engineering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../09/data-pipelines.html">
     9.2. Data Pipelines
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Section 3: Modeling With Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../10/introduction.html">
   10. Modeling Basics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../10/intro-modeling.html">
     10.1. Introduction to Statistical Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../10/model-building.html">
     10.2. Building Modeling Pipelines
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../11/introduction.html">
   11. Bias and Variance
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../11/fitting-inference.html">
     11.1. Model Quality (Inference)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11/fitting-prediction.html">
     11.2. Model Quality (Prediction)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11/cross-validation.html">
     11.3. Cross Validation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11/parameter-search.html">
     11.4. Parameter Search
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../12/introduction.html">
   12. Evaluating Models; Fairness
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../12/eval.html">
     12.1. Evaluation metrics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12/parity.html">
     12.2. Parity Measures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12/fairness.html">
     12.3. Fairness in Machine Learning
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/content/05/understanding-aggregations.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/dsc-courses/ds-in-practice/master?urlpath=tree/book/content/05/understanding-aggregations.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reshaping-data-pivot-tables">
   Reshaping Data: Pivot Tables
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conditional-distributions-are-pivot-tables">
     Conditional distributions are pivot tables
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#undoing-a-pivot">
     Undoing a pivot
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reversing-aggregations-ecological-fallacies">
   Reversing aggregations: ecological fallacies
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simpson-s-paradox">
     Simpson’s Paradox
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Understanding Aggregations</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reshaping-data-pivot-tables">
   Reshaping Data: Pivot Tables
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conditional-distributions-are-pivot-tables">
     Conditional distributions are pivot tables
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#undoing-a-pivot">
     Undoing a pivot
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reversing-aggregations-ecological-fallacies">
   Reversing aggregations: ecological fallacies
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simpson-s-paradox">
     Simpson’s Paradox
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="understanding-aggregations">
<h1>Understanding Aggregations<a class="headerlink" href="#understanding-aggregations" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p>Data aggregation is a powerful tool that allows one to understand a population via summarization; changing the granularity of data from individual observations to groups of observations can make patterns suddenly clear.</p>
<ul class="simple">
<li><p>Computing distributions is an example.</p></li>
<li><p>descriptions grouped by labels, instead of individuals.</p></li>
</ul>
<div class="section" id="reshaping-data-pivot-tables">
<h2>Reshaping Data: Pivot Tables<a class="headerlink" href="#reshaping-data-pivot-tables" title="Permalink to this headline">¶</a></h2>
<p>Pivot tables are compact ways of summarizing groups within data. The pivot refers to <em>reshaping</em> a table from a long table of rows indexed by two characteristics, to a wide table with one characteristic per axis.</p>
<p>As a simple example, consider a table of aggregate student records resulting from a groupby operation; each record contains the GPA of all members of one year’s student body for a given department:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Year</p></th>
<th class="head"><p>Course Dept</p></th>
<th class="head"><p>Avg Grade</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Senior</p></td>
<td><p>CS</p></td>
<td><p>3.3</p></td>
</tr>
<tr class="row-odd"><td><p>Senior</p></td>
<td><p>Math</p></td>
<td><p>2.9</p></td>
</tr>
<tr class="row-even"><td><p>Senior</p></td>
<td><p>DS</p></td>
<td><p>3.1</p></td>
</tr>
<tr class="row-odd"><td><p>Junior</p></td>
<td><p>CS</p></td>
<td><p>3.4</p></td>
</tr>
<tr class="row-even"><td><p>Junior</p></td>
<td><p>Math</p></td>
<td><p>3.0</p></td>
</tr>
<tr class="row-odd"><td><p>Junior</p></td>
<td><p>DS</p></td>
<td><p>3.0</p></td>
</tr>
<tr class="row-even"><td><p>Sophomore</p></td>
<td><p>CS</p></td>
<td><p>3.0</p></td>
</tr>
<tr class="row-odd"><td><p>Sophomore</p></td>
<td><p>Math</p></td>
<td><p>3.1</p></td>
</tr>
<tr class="row-even"><td><p>Sophomore</p></td>
<td><p>DS</p></td>
<td><p>2.9</p></td>
</tr>
<tr class="row-odd"><td><p>Freshman</p></td>
<td><p>CS</p></td>
<td><p>3.2</p></td>
</tr>
<tr class="row-even"><td><p>Freshman</p></td>
<td><p>Math</p></td>
<td><p>3.2</p></td>
</tr>
<tr class="row-odd"><td><p>Freshman</p></td>
<td><p>DS</p></td>
<td><p>3.2</p></td>
</tr>
<tr class="row-even"><td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
</tbody>
</table>
<p>While this table is easy to work with, drawing quick comparisons across attributes is cumbersome. A pivot table created from these averages involves reshaping the long table to a wider, more compact, format. In this case:</p>
<ul class="simple">
<li><p>the index of the pivot table contains the unique values of ‘Course Dept’,</p></li>
<li><p>the columns of the pivot table contains the unique values of ‘Year’,</p></li>
<li><p>The values of the pivot table contains the values of ‘Avg Grade’</p></li>
</ul>
<p>The pivot table:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>—</p></th>
<th class="head"><p>Freshman</p></th>
<th class="head"><p>Sophomore</p></th>
<th class="head"><p>Junior</p></th>
<th class="head"><p>Senior</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CS</p></td>
<td><p>3.2</p></td>
<td><p>3.0</p></td>
<td><p>3.4</p></td>
<td><p>3.3</p></td>
</tr>
<tr class="row-odd"><td><p>Math</p></td>
<td><p>3.2</p></td>
<td><p>3.1</p></td>
<td><p>3.0</p></td>
<td><p>2.9</p></td>
</tr>
<tr class="row-even"><td><p>DS</p></td>
<td><p>3.2</p></td>
<td><p>2.9</p></td>
<td><p>3.0</p></td>
<td><p>3.1</p></td>
</tr>
<tr class="row-odd"><td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
</tbody>
</table>
<p>In Pandas, such a reshaping is done with the <code class="docutils literal notranslate"><span class="pre">pivot</span></code> method.</p>
<p><em>Remarks:</em></p>
<ul class="simple">
<li><p>In the pivot table one can easily spot the trend that, as students progress, math classes get harder, while CS classes get easier.</p></li>
<li><p>The ‘Year’ values were set as the columns of the pivot table, as there are only 4 distinct values; there may be many departments.</p></li>
<li><p>The pivot is merely a <em>reshaping</em> of the original table; the number of entries in the pivot is the same as the number of rows in the original table.</p></li>
</ul>
<p><strong>Example:</strong> Recall the dataset consisting of attempts to summit Mt. Rainier. Even among just the 10 most popular climbing routes, listing the number of climbers who attempted each route on every given day results in a long table with 895 rows. Such a table is hard to manually inspect!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">climbers_by_route_day</span> <span class="o">=</span> <span class="n">popular_climbs</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;Route&#39;</span><span class="p">])[</span><span class="s1">&#39;Attempted&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">climbers_by_route_day</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Route</th>
      <th>Attempted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1/16/2014</td>
      <td>Little Tahoma</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1/18/2014</td>
      <td>Gibraltar Ledges</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1/19/2014</td>
      <td>Gibraltar Ledges</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>892</th>
      <td>9/8/2015</td>
      <td>Disappointment Cleaver</td>
      <td>2</td>
    </tr>
    <tr>
      <th>893</th>
      <td>9/9/2014</td>
      <td>Disappointment Cleaver</td>
      <td>29</td>
    </tr>
    <tr>
      <th>894</th>
      <td>9/9/2015</td>
      <td>Disappointment Cleaver</td>
      <td>16</td>
    </tr>
  </tbody>
</table>
<p>895 rows × 3 columns</p>
</div></div></div>
</div>
<p>The pivot table present the attempts by day and route in a matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">climbers_by_route_day</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Route&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Attempted&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Route</th>
      <th>Disappointment Cleaver</th>
      <th>Emmons-Winthrop</th>
      <th>Fuhrer's Finger</th>
      <th>Gibraltar Ledges</th>
      <th>Ingraham Direct</th>
      <th>Kautz Glacier</th>
      <th>Liberty Ridge</th>
      <th>Little Tahoma</th>
      <th>Ptarmigan Ridge</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1/16/2014</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1/18/2014</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1/19/2014</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9/8/2015</th>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9/9/2014</th>
      <td>29.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9/9/2015</th>
      <td>16.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>386 rows × 9 columns</p>
</div></div></div>
</div>
<p>In this pivot table, the entries with <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values correspond to day where a climbing route had no one attempt it; filling in the <code class="docutils literal notranslate"><span class="pre">NaN</span></code> entries with zero in this case makes sense (this is <em>not</em> always the case, however!).</p>
<p>The pattern of performing a <code class="docutils literal notranslate"><span class="pre">groupby</span></code> operation followed by a reshaping operation is so common, Pandas provides a method that combines the two.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> DataFrame method is like <code class="docutils literal notranslate"><span class="pre">pivot</span></code> with an additional keyword argument <code class="docutils literal notranslate"><span class="pre">aggfunc</span></code> that applies the provided function on the groups defined by the columns specified by the <code class="docutils literal notranslate"><span class="pre">index</span></code>/<code class="docutils literal notranslate"><span class="pre">column</span></code> arguments:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">popular_climbs</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> 
    <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Route&#39;</span><span class="p">,</span> 
    <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Attempted&#39;</span><span class="p">,</span> 
    <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span>
    <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Route</th>
      <th>Disappointment Cleaver</th>
      <th>Emmons-Winthrop</th>
      <th>Fuhrer's Finger</th>
      <th>Gibraltar Ledges</th>
      <th>Ingraham Direct</th>
      <th>Kautz Glacier</th>
      <th>Liberty Ridge</th>
      <th>Little Tahoma</th>
      <th>Ptarmigan Ridge</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1/16/2014</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1/18/2014</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1/19/2014</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9/8/2015</th>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9/9/2014</th>
      <td>29</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9/9/2015</th>
      <td>16</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>386 rows × 9 columns</p>
</div></div></div>
</div>
<p><em>Remark:</em> The <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">pivot</span></code> when the aggregation function is the identity function (<code class="docutils literal notranslate"><span class="pre">aggfunc=lambda</span> <span class="pre">x:x</span></code>).</p>
<div class="section" id="conditional-distributions-are-pivot-tables">
<h3>Conditional distributions are pivot tables<a class="headerlink" href="#conditional-distributions-are-pivot-tables" title="Permalink to this headline">¶</a></h3>
<p><strong>Example:</strong> To understand where and when most <em>individual climbers</em> are on Mt. Rainier, compute</p>
<ol class="simple">
<li><p>the distribution of Routes that climber’s use to attempt to summit the mountain,</p></li>
<li><p>the distribution of months of the year when climbers attempt to summit the mountain,</p></li>
<li><p>the conditional distribution of routes climbed by month of the year.</p></li>
</ol>
<p>Note that this is <em>not</em> asking for the distribution of routes used by climbing parties (which corresponds to a row of the dataframe), but rather the distribution of routes used by climbers.</p>
<p>Before calculating the desired distributions, the month of the year must be stripped from the ‘Date’ attribute:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">popular_climbs_with_month</span> <span class="o">=</span> <span class="n">popular_climbs</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">Month</span><span class="o">=</span><span class="n">popular_climbs</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>The distribution of routes used by climbers is computed by calculating the total number of climbers that attempted each route up the mountain, then normalizing each sum by the total number of climbers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">climbers_by_route</span> <span class="o">=</span> <span class="n">popular_climbs_with_month</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Route&#39;</span><span class="p">)[</span><span class="s1">&#39;Attempted&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">climbers_by_route_distr</span> <span class="o">=</span> <span class="n">climbers_by_route</span> <span class="o">/</span> <span class="n">climbers_by_route</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">climbers_by_route_distr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Route
Disappointment Cleaver    0.745837
Emmons-Winthrop           0.148707
Fuhrer&#39;s Finger           0.013372
                            ...   
Liberty Ridge             0.008082
Little Tahoma             0.014498
Ptarmigan Ridge           0.002792
Name: Attempted, Length: 9, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">climbers_by_route_distr</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;distribution of routes used by individual climbers&#39;</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/understanding-aggregations_17_0.png" src="../../_images/understanding-aggregations_17_0.png" />
</div>
</div>
<p>Notice that two of the routes on the mountain account for almost 90% of the climbers on the mountain during that time! Similarly, the distribution of months in which individual climbers attempted to summit Mt. Rainier is calculated by:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">climbers_by_month</span> <span class="o">=</span> <span class="n">popular_climbs_with_month</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)[</span><span class="s1">&#39;Attempted&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="n">climbers_by_month_distr</span> <span class="o">=</span> <span class="n">climbers_by_month</span> <span class="o">/</span> <span class="n">climbers_by_month</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">climbers_by_month_distr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Month
1     0.005192
2     0.003967
3     0.007494
        ...   
10    0.001567
11    0.000245
12    0.000147
Name: Attempted, Length: 12, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">climbers_by_month_distr</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/understanding-aggregations_20_0.png" src="../../_images/understanding-aggregations_20_0.png" />
</div>
</div>
<p>Most climbers attempt to summit Rainier during the summer months of June, July, and August.</p>
<p>To compute the conditional distribution, calculate the total number of climbers that attempted a route in a given month, then normalize by the total number of climbers. This gives the proportion of climbing activity that occurs in a given time and place on the mountain.</p>
<p>First, calculate the sums – recall that <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> performs the <code class="docutils literal notranslate"><span class="pre">groupby</span></code>!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">climbers_by_month_route</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">popular_climbs_with_month</span>
    <span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Route&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Attempted&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">climbers_by_month_route</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Route</th>
      <th>Disappointment Cleaver</th>
      <th>Emmons-Winthrop</th>
      <th>Fuhrer's Finger</th>
      <th>Gibraltar Ledges</th>
      <th>Ingraham Direct</th>
      <th>Kautz Glacier</th>
      <th>Liberty Ridge</th>
      <th>Little Tahoma</th>
      <th>Ptarmigan Ridge</th>
    </tr>
    <tr>
      <th>Month</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>0</td>
      <td>5</td>
      <td>56</td>
      <td>21</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>23</td>
      <td>0</td>
      <td>4</td>
      <td>36</td>
      <td>16</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>60</td>
      <td>0</td>
      <td>7</td>
      <td>19</td>
      <td>62</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>10</th>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>12 rows × 9 columns</p>
</div></div></div>
</div>
<p>Then normalize by the total number of climbers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total_climbers</span> <span class="o">=</span> <span class="n">climbers_by_month_route</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">climbers_by_month_route_distr</span> <span class="o">=</span> <span class="n">climbers_by_month_route</span> <span class="o">/</span> <span class="n">total_climbers</span>
<span class="n">climbers_by_month_route_distr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Route</th>
      <th>Disappointment Cleaver</th>
      <th>Emmons-Winthrop</th>
      <th>Fuhrer's Finger</th>
      <th>Gibraltar Ledges</th>
      <th>Ingraham Direct</th>
      <th>Kautz Glacier</th>
      <th>Liberty Ridge</th>
      <th>Little Tahoma</th>
      <th>Ptarmigan Ridge</th>
    </tr>
    <tr>
      <th>Month</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.000980</td>
      <td>0.0</td>
      <td>0.000245</td>
      <td>0.002743</td>
      <td>0.001029</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000196</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.001127</td>
      <td>0.0</td>
      <td>0.000196</td>
      <td>0.001763</td>
      <td>0.000784</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000098</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.002939</td>
      <td>0.0</td>
      <td>0.000343</td>
      <td>0.000931</td>
      <td>0.003037</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000245</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.000980</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000196</td>
      <td>0.0</td>
      <td>0.000392</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.000245</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000147</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>12 rows × 9 columns</p>
</div></div></div>
</div>
<p>The table representing the conditional distribution is quite large; there are 120 combinations of month/route, most of which represent very few climbers. Looking at only the most popular routes, during the most popular months:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">climbers_by_month_route_distr</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="c1"># summer months</span>
    <span class="p">[</span><span class="s1">&#39;Disappointment Cleaver&#39;</span><span class="p">,</span> <span class="s1">&#39;Emmons-Winthrop&#39;</span><span class="p">,</span> <span class="s1">&#39;Kautz Glacier&#39;</span><span class="p">]</span> <span class="c1"># top three most popular Routes</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Route</th>
      <th>Disappointment Cleaver</th>
      <th>Emmons-Winthrop</th>
      <th>Kautz Glacier</th>
    </tr>
    <tr>
      <th>Month</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>0.075823</td>
      <td>0.004065</td>
      <td>0.001322</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.182259</td>
      <td>0.048491</td>
      <td>0.017535</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.216742</td>
      <td>0.070337</td>
      <td>0.018417</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.175647</td>
      <td>0.025078</td>
      <td>0.007886</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.084542</td>
      <td>0.000735</td>
      <td>0.000245</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Notice that ~20% of the climbing on Mt. Ranier occurs during a single year, on a single route!</p>
<p><em>Remark:</em> One can recover the distributions of routes/months (i.e. the <em>marginal</em> distributions) by summing the rows/columns of the conditional distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Distribution of Routes</span>
<span class="n">climbers_by_month_route_distr</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Route
Disappointment Cleaver    0.745837
Emmons-Winthrop           0.148707
Fuhrer&#39;s Finger           0.013372
                            ...   
Liberty Ridge             0.008082
Little Tahoma             0.014498
Ptarmigan Ridge           0.002792
Length: 9, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Distribution of Months</span>
<span class="n">climbers_by_month_route_distr</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Month
1     0.005192
2     0.003967
3     0.007494
        ...   
10    0.001567
11    0.000245
12    0.000147
Length: 12, dtype: float64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="undoing-a-pivot">
<h3>Undoing a pivot<a class="headerlink" href="#undoing-a-pivot" title="Permalink to this headline">¶</a></h3>
<p>While statistics of datasets are often more readable in a pivot table, a longer table with well-defined observations and attributes is easier to compute with. If a table is stored as a pivot table, one can undo the pivot using the <code class="docutils literal notranslate"><span class="pre">melt</span></code> method.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">melt</span></code> only undoes the reshaping operation of <code class="docutils literal notranslate"><span class="pre">pivot</span></code> – in general, the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> aggregations cannot be inverted!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">climbers_by_month_route</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;Total Attempts&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Month</th>
      <th>Route</th>
      <th>Total Attempts</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Disappointment Cleaver</td>
      <td>20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Disappointment Cleaver</td>
      <td>23</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Disappointment Cleaver</td>
      <td>60</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>105</th>
      <td>10</td>
      <td>Ptarmigan Ridge</td>
      <td>0</td>
    </tr>
    <tr>
      <th>106</th>
      <td>11</td>
      <td>Ptarmigan Ridge</td>
      <td>0</td>
    </tr>
    <tr>
      <th>107</th>
      <td>12</td>
      <td>Ptarmigan Ridge</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>108 rows × 3 columns</p>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="reversing-aggregations-ecological-fallacies">
<h2>Reversing aggregations: ecological fallacies<a class="headerlink" href="#reversing-aggregations-ecological-fallacies" title="Permalink to this headline">¶</a></h2>
<p>Grouping “like” individuals together and reducing them to a few numbers like a median or mean turns understanding a large population a tractable problem. However, this process necessarily loses information about the underlying population. When working with aggregate data, keeping clear the population of interest is of the utmost importance; confusing individuals for groups of individuals often leads to incorrect conclusions!</p>
<p>An <strong>ecological fallacy</strong> refers to drawing conclusions about individuals through conclusions made from aggregate descriptions of the data. Such conclusion often fail for two complementary reasons:</p>
<ul class="simple">
<li><p>An aggregate view of the data obscures the relationship between the groups. For example, viewing a population through a group-wise mean masks the relative sizes of the groups.</p></li>
<li><p>An aggregate view of the data hides the riches of the intra-group population. For example, view a population through a group-wise mean conceals the shape of the distributions within each group (e.g. the existence of outliers, skewness, etc).</p></li>
</ul>
<p><strong>Example:</strong> Suppose a group of people have higher incomes on average than the population as a whole. This does not imply that a randomly chosen member of the group is more likely to make an above average wage. As an extreme example to see why this is true, consider a group of 5 individuals: 4 of them makes \<span class="math notranslate nohighlight">\(0 per year and the other makes \\\)</span>1M per year. The group average is \<span class="math notranslate nohighlight">\(200K per year, which is above the average income in the population. However, 80% of the time, a randomly chosen individual from the group makes below the average income of the population, since they make \)</span>0 per year. Drawing a conclusion about the individuals in a group is more related to the median of the distribution of the group than the mean; however, this quantity is not contained in the aggregate description.</p>
<div class="section" id="simpson-s-paradox">
<h3>Simpson’s Paradox<a class="headerlink" href="#simpson-s-paradox" title="Permalink to this headline">¶</a></h3>
<p>Simpson’s Paradox is less a paradox and more a simple arithmetic phenomenon: group-wise averages can look drastically different depending on how finely the data are grouped. The phenomenon seems paradoxical from the tendency to make inferences about individuals from these group-wise summaries: the grouped data can describe an individual in two seemingly incompatible ways.</p>
<p>Simpson’s Paradox occurs in a dataset when aggregate trends reverse upon further partitioning the data. The most simple examples concern average rates of occurrence of some event:</p>
<p><strong>Example:</strong> A <a class="reference external" href="https://www.bmj.com/content/309/6967/1480.full">medical study</a> in BMJ studied the relative success rates of two different procedures removing kidney stones from patients. The first procedure involves removing the stone via traditional “open surgery” (OS), whereas the second procedure involves removing the stone using a small puncture (PN). Among 700 patients treated, the success rate of PN was higher than the success rate of OS:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>OS</p></th>
<th class="head"><p>PN</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>78% (273/350)</p></td>
<td><p><strong>83% (289/350)</strong></p></td>
</tr>
</tbody>
</table>
<p>However, OS had a higher success rate when used on patients with smaller kidney stones, <em>as well as</em> on patients with larger kidney stones:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>—</p></th>
<th class="head"><p>OS</p></th>
<th class="head"><p>PN</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Small Stones</p></td>
<td><p><strong>93% (81/87)</strong></p></td>
<td><p>87% (234/270)</p></td>
</tr>
<tr class="row-odd"><td><p>Large Stones</p></td>
<td><p><strong>73% (192/263)</strong></p></td>
<td><p>69% (55/80)</p></td>
</tr>
<tr class="row-even"><td><p>Both</p></td>
<td><p>78% (273/350)</p></td>
<td><p><strong>83% (289/350)</strong></p></td>
</tr>
</tbody>
</table>
<p>Which treatment is more effective? The two pictures contradict each other!</p>
<p>Observing the raw numbers in the study, one notices most of the procedures fall into only 2/4 cases:</p>
<ul class="simple">
<li><p>Open Surgery (OS) on large stones, and</p></li>
<li><p>Puncture procedure (PN) on small stones.</p></li>
</ul>
<p>That is to say, treatment OS was mostly evaluated on large kidney stones, whereas treatment PN was largely evaluated on small kidney stones. This comparison is not a fair one, as removing a large kidney stone is more difficult operation than removing a small one. As such, it seems that Open Surgery may actually be the more effective procedure.</p>
<p>However, randomizing the two groups for treatment is the best way to truly determine effectiveness, as there may be other, similar attributes that have a similar effective and further reverse the conclusion!</p>
<p><strong>Example:</strong> Suppose a mountain climber with ambitions of climbing Mt. Rainier is trying to decide both</p>
<ol class="simple">
<li><p>which route to climb to attempt to summit the mountain and</p></li>
<li><p>whether to attempt the climb in the summer or the winter.</p></li>
</ol>
<p>Being quantitatively inclined, she turns to the dataset of past climbing attempts. First, she would like to either climb the ‘Emmons-Winthrop’ route (the most straightforward route, up the mountain’s largest glacier) or the ‘Gibraltar Ledges’ route (the route used in the first known successful summit of Rainier).</p>
<p>Computing the success rate that mountaineers for each route, she notes that people have more success summiting the Emmons-Winthrop route:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">routes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Emmons-Winthrop&#39;</span><span class="p">,</span> <span class="s1">&#39;Gibralter Ledges&#39;</span><span class="p">]</span>

<span class="p">(</span>
    <span class="n">popular_climbs</span>
    <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">popular_climbs</span><span class="p">[</span><span class="s1">&#39;Route&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">routes</span><span class="p">)]</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Route&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;Succeeded&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;Attempted&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;Success Rate&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Success Rate</th>
    </tr>
    <tr>
      <th>Route</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Emmons-Winthrop</th>
      <td>0.549736</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Next, she would like to know when to climb the route, so she computes the success rates of each route when summiting during summer vs winter:</p>
<ul class="simple">
<li><p>compute a column specifying the season (e.g. summer is between June and October inclusive, winter is everyting else),</p></li>
<li><p>compute the rates by season and route</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summer_or_winter</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">popular_climbs_with_month</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;Winter&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;Summer&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ew_gl_cnts</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">popular_climbs</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">Season</span><span class="o">=</span><span class="n">summer_or_winter</span><span class="p">)</span>
    <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">popular_climbs</span><span class="p">[</span><span class="s1">&#39;Route&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">routes</span><span class="p">)]</span>
    <span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
        <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Season&#39;</span><span class="p">,</span> 
        <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Route&#39;</span><span class="p">,</span> 
        <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Attempted&#39;</span><span class="p">,</span> <span class="s1">&#39;Succeeded&#39;</span><span class="p">],</span> 
        <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">ew_gl_cnts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>Attempted</th>
      <th>Succeeded</th>
    </tr>
    <tr>
      <th>Route</th>
      <th>Emmons-Winthrop</th>
      <th>Emmons-Winthrop</th>
    </tr>
    <tr>
      <th>Season</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Summer</th>
      <td>2953</td>
      <td>1649</td>
    </tr>
    <tr>
      <th>Winter</th>
      <td>83</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ew_gl_success_rates</span> <span class="o">=</span> <span class="n">ew_gl_cnts</span><span class="p">[</span><span class="s1">&#39;Succeeded&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">ew_gl_cnts</span><span class="p">[</span><span class="s1">&#39;Attempted&#39;</span><span class="p">]</span>
<span class="n">ew_gl_success_rates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Route</th>
      <th>Emmons-Winthrop</th>
    </tr>
    <tr>
      <th>Season</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Summer</th>
      <td>0.558415</td>
    </tr>
    <tr>
      <th>Winter</th>
      <td>0.240964</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Breaking down the success rates by season reveals a <em>reversal</em>. Counter to the previous comparison, Gibraltar Ledges has a higher success rate in <em>both</em> the winter and the summer! <em>But which route should she climb? and when?</em></p>
<p>A peak at the underlying raw number of attempts is illuminating:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ew_gl_cnts</span><span class="p">[</span><span class="s1">&#39;Succeeded&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Route</th>
      <th>Emmons-Winthrop</th>
    </tr>
    <tr>
      <th>Season</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Summer</th>
      <td>1649</td>
    </tr>
    <tr>
      <th>Winter</th>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The primary observations of these counts that are hidden in the tables of success rates are:</p>
<ul class="simple">
<li><p>The number of climbers that attempted Gibraltar Ledges perhaps too small to trust! Perhaps six of the eight climbers who successfully climbed to the summit were merely lucky?</p></li>
<li><p>The ‘Emmons-Winthrop’ route is primarily attempted in summer, whereas the ‘Gibraltar Ledges’ route is primarily attempted in winter.</p></li>
</ul>
<p>Further background research also reveals that climbing in the winter is typically a more demanding, dangerous affair, with unsettled weather and shorter days; this observation might imply that the population of climbers attempting routes in the winter may be more skilled than climbers attempting to summit the mountain in the summer. Thus, most climbers on Gibraltar Ledges are actually <em>better climbers that are more likely to successfully summit</em>.</p>
<p>Our data scientist, recognizing herself as being new to the endeavor, realizes that climbing the Emmons-Winthrop route is her best bet for success.</p>
<p><em>Remark:</em> Don’t be fooled by the 75% success rate! For both of the reasons outlined above, attempting the Gibraltar Ledges route in the Summer is a terrible idea: “Due to loose rock, this route should only be attempted in cold conditions.” (See more <a class="reference external" href="https://www.summitpost.org/gibralter-ledges/160662">here</a> on the route description).</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/05"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="grouping.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Data Granularity:</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="appending-data.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Combining Data: Observations</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Aaron Fraenkel<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>